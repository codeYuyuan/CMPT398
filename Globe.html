
<!-- saved from url=(0061)http://www.ourd3js.com/map/demo/worldmap_sphere/worldmap.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  
          
        <title>Globe</title>  
  <style>

.map_path {
	stroke: black;
	stroke-width: 1;
}

.grid_path{
	stroke: gray;
	stroke-width: 1;
	fill:none;
	opacity: 1;
}

</style>
</head> 

<body>
<script src="./Globe_files/d3.v3.min.js"></script>
<script>
	var width  = 500;
	var height = 440;
	var speed = 0.5;
	var isMouseOn = false;
	
	var svg = d3.select("body").append("svg")
	    .attr("width", width)
	    .attr("height", height);
	
	var projection = d3.geo.orthographic()
						.scale(200);
						
	var graticule = d3.geo.graticule();
	
	var path = d3.geo.path()
					.projection(projection);
	
	var color = d3.scale.category20();
	
	svg.append("text")
		.attr("id","loading")
		.attr("x",width/2)
		.attr("y",height/2)
		.text("Now Loading...");
	
	d3.json("world_605kb.json", function(error, root) {
		if (error) 
			return console.error(error);
		console.log(root);
		
		var grid = graticule();
		
		console.log(grid);
		
		var map = svg.append("g")
					 .attr("transform", "translate(" +  -230 + "," + -20 + ")");
		
		map.append("path")
			.datum( grid )
			.attr("id","grid_id")
			.attr("class","grid_path")
			.attr("d",path);
		
		map.selectAll(".map_path")
				.data( root.features )
				.enter()
				.append("path")
				.attr("class","map_path")
				.attr("fill",function(d,i){
					return color(i);
				})
				.attr("d", path )
				.on("mouseover",function(d,i){
					// console.log(d);
					console.log(d.properties.BRK_NAME);
					isMouseOn = true;
					d3.select(this)
						.attr("fill","yellow");
				})
				.on("mouseout",function(d,i){
					isMouseOn = false;
					d3.select(this)
						.attr("fill",color(i));
				});;

		svg.select("#loading")
			.attr("opacity",0);
		

		
		var offset = 0;
		var positionLock = 0;
		currentDegree = 0;

		d3.timer(function() {
			if(!isMouseOn){
				projection.rotate([speed * (currentDegree++), -15]).clipAngle(90);
			}
			map.select("#grid_id")
				.attr("d",path);
			
			map.selectAll(".map_path")
				.attr("d",path);

			
		});
		
	});
	

</script>
	</body>
</html>